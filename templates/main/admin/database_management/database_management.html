{% load staticfiles %}
<link rel="stylesheet" href={% static "main/admin/database_management/database_management.css" %}>
<script src={% static "main/admin/database_management/database_management.js" %}></script>


<div class="main_content">

    <div class="content_title">数据库管理</div>

    <div class="project_item">
        <div class="project_item_title">数据库备份</div>

        <div style="margin: 0 0 5px 20px;">数据库备份会在服务器存储一份备份，并提供一份备份以供下载另行存储</div>
        <div style="margin: 0 0 0 20px;">输入文件名后点击"数据库备份"按钮即可备份，放空则默认为以日期命名</div>
        <div style="margin: 0 0 0 20px;">另：目前只支持英文文件名，可下载后自行修改，本问题会尽快修复</div>

        <div class="database_dump_area">
            <div class="database_dump_title">文件名</div>

            <form id="database_dump_form" method="post" action="/export" autocomplete="off">
                {% csrf_token %}
                <input type="hidden" name="username" value="{{ user.id }}">
                <input type="hidden" name="requestfor" value="database_backup">

                <input id="database_dump_filename" name="filename">
            </form>

            <div id="database_dump_button">数据库备份</div>
        </div>
    </div>

    <div class="project_item">
        <div class="project_item_title">备份记录</div>
        <div style="margin: 0 0 12px 20px;">数据库恢复会将服务器数据库恢复至所选备份，未先行备份的数据会丢失，因此强烈推荐先将现行数据备份后再进行恢复操作</div>

        <table>
            <tr>
                <th width="400px">备份时间</th>
                <th width="300px">下载</th>
                <th width="300px">还原</th>
            </tr>

            {% if backup_infos %}
                {% for info in backup_infos %}
                    <tr>
                        <td>{{ info.2 }}</td>
                        <td>{{ info.1 }}</td>
                        <td></td>
                    </tr>
                {% endfor %}
            {% endif %}

        </table>
    </div>
</div>